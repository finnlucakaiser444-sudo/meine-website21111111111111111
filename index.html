<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SAAF 7RB â€” Neu</title>
  <style>
    :root{--p:#667eea;--s:#764ba2;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial; margin:16px;background:linear-gradient(135deg,var(--p),var(--s));color:#0f172a}
    .wrap{max-width:980px;margin:0 auto;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 12px 36px rgba(2,6,23,.18)}
    header{display:flex;justify-content:space-between;align-items:center;padding:18px;background:linear-gradient(135deg,var(--p),var(--s));color:#fff}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:10px;background:#fff;display:flex;align-items:center;justify-content:center}
    main{padding:18px;display:grid;gap:14px}
    .card{background:linear-gradient(180deg,#fafbff,#f5f7ff);padding:14px;border-radius:10px;border:1px solid #e6ecff}
    .card h2{margin:0 0 12px;color:var(--p);font-size:1.05rem}
    .btn{background:linear-gradient(135deg,var(--p),var(--s));color:#fff;padding:10px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
    .btn.ghost{background:transparent;color:var(--p);border:1px solid #e6ecff}
    .small{padding:8px 10px;font-size:.9rem}
    .list{list-style:none;padding:0;margin:0;display:grid;gap:10px}
    .item{background:#fff;padding:12px;border-radius:8px;border:1px solid #eef2ff;display:flex;justify-content:space-between;align-items:center}
    .meta{font-size:.9rem;color:var(--muted)}
    .admin-only{display:none}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1000}
    .modal.show{display:flex}
    .modal-card{background:#fff;padding:16px;border-radius:10px;max-width:480px;width:100%}
    .roles{display:flex;gap:8px}
    .role-btn{flex:1;padding:10px;border-radius:8px;border:2px solid #eee;background:#fff;cursor:pointer}
    .role-btn.active{background:var(--p);color:#fff;border-color:var(--p)}
    input,textarea,select{width:100%;padding:10px;border:1px solid #e6e9f2;border-radius:8px}
    .collapse{border-radius:8px;overflow:hidden}
    .collapse-header{display:flex;justify-content:space-between;align-items:center;padding:12px;background:linear-gradient(90deg,#eef2ff,#f7f7ff);cursor:pointer}
    .collapse-body{display:none;padding:12px;background:#fff}
    .collapse-body.show{display:block}
    canvas{width:100%;height:380px;background:#87ceeb;display:block;border-radius:8px}
    @media(min-width:768px){canvas{height:480px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo"><img src="Download.png" alt="logo" style="width:100%;height:100%;object-fit:contain"></div>
        <div>
          <div style="font-weight:800">ğŸ“š SAAF 7RB</div>
          <div style="font-size:.9rem;opacity:.95">Hausaufgaben, Termine & Spiele</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <div id="roleBadge" style="background:rgba(255,255,255,.12);padding:8px 12px;border-radius:999px;font-weight:700">ğŸ‘¤ Gast</div>
        <button class="btn small" onclick="openLogin()">ğŸ” Anmelden</button>
      </div>
    </header>

    <main>
      <section class="card">
        <h2> ğŸ—’ï¸Termine</h2>
        <ul id="tasks" class="list"></ul>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn small" onclick="openTaskModal()">â• Termine hinzufÃ¼gen</button>
          <button class="btn small ghost admin-only" id="addEventBtn" onclick="openEventModal()">â• Hausaufgaben hinzufÃ¼gen</button>
        </div>
      </section>
      
      <section class="card">
        <h2>ğŸ—’ï¸ Hausaufgaben</h2>
        <ul id="events" class="list"></ul>
      </section>

      <section class="card">
        <h2>ğŸ—’ï¸ Notizen</h2>
        <textarea id="noteInput" rows="3" style="margin-bottom:8px" placeholder="Notiz..."></textarea>
        <div style="display:flex;gap:8px">
          <button class="btn small" onclick="saveNote()">ğŸ“Œ Speichern</button>
          <button class="btn small ghost" onclick="clearNotes()">ğŸ§¹ Leeren</button>
        </div>
        <ul id="notes" class="list" style="margin-top:10px"></ul>
      </section>

      <section class="card collapse" id="gameSection">
        <div class="collapse-header" onclick="toggleGamePanel()">
          <div style="font-weight:800">ğŸ® Flappy Person BETA  â€” Spiel</div>
          <div id="gameToggleLabel" style="opacity:.85">Klicken um zu Ã¶ffnen</div>
        </div>
        <div class="collapse-body" id="gameBody">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div>Score: <span id="gscore">0</span> â€” Best: <span id="gbest">0</span></div>
            <div style="display:flex;gap:8px">
              <button class="btn small" onclick="startGame()">â–¶ Start</button>
              <button class="btn small ghost" onclick="stopGame()">â¹ Stop</button>
            </div>
          </div>
          <canvas id="gameCanvas"></canvas>
          <div style="margin-top:8px;color:var(--muted)">Klick oder Leertaste zum Springen â€¢ ESC zum Beenden</div>
        </div>
      </section>
    </main>

    <footer style="padding:14px;text-align:center;color:var(--muted);background:linear-gradient(180deg,#fbfbff,#f5f7ff);border-top:1px solid #e6ecff">
      <div>ğŸ« SAAF 7RB â€¢ November 2025 â€” Erstellt von Finn-Luca Kaiser</div>
    </footer>
  </div>

  <!-- Modals -->
  <div class="modal" id="loginModal">
    <div class="modal-card">
      <h3 style="margin:0 0 10px 0">ğŸ”“ Anmelden</h3>
      <div id="loginMsg" style="margin-bottom:8px;color:#0f172a;font-weight:700"></div>
      <div id="roleSelect" style="margin-bottom:8px">
        <div style="margin-bottom:6px">WÃ¤hle Rolle:</div>
        <div class="roles">
          <button class="role-btn" onclick="pickRole('student', this)">ğŸ‘¤ SchÃ¼ler</button>
          <button class="role-btn" onclick="pickRole('teacher', this)">ğŸ‘¨â€ğŸ« Lehrer</button>
          <button class="role-btn" onclick="pickRole('admin', this)">ğŸ‘¨â€ğŸ’¼ Admin</button>
        </div>
      </div>
      <div id="pwSection" style="display:none;margin-top:8px">
        <div id="roleText" style="margin-bottom:8px;font-weight:700"></div>
        <input id="pwInput" type="password" placeholder="Passwort" />
        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn small" onclick="confirmLogin()">BestÃ¤tigen</button>
          <button class="btn small ghost" onclick="closeLogin()">Abbrechen</button>
        </div>
        <div id="loginError" style="color:#ef4444;margin-top:8px;display:none"></div>
      </div>
      <div style="margin-top:10px"><button class="btn small ghost" onclick="closeLogin()">SchlieÃŸen</button></div>
    </div>
  </div>

  <div class="modal" id="taskModal">
    <div class="modal-card">
      <h3 style="margin:0 0 8px 0">â• Neue Aufgabe</h3>
      <input id="tName" type="text" placeholder="Titel" style="margin-bottom:8px" />
      <input id="tDesc" type="text" placeholder="Beschreibung" style="margin-bottom:8px" />
      <div style="display:flex;gap:8px;margin-bottom:8px">
        <input id="tSubject" type="text" placeholder="Fach" />
        <select id="tLevel"><option value="leicht">leicht</option><option value="mittel">mittel</option><option value="schwer">schwer</option></select>
      </div>
      <div style="display:flex;gap:8px">
        <input id="tDeadline" type="date" />
        <button class="btn small" onclick="saveTask()">Speichern</button>
        <button class="btn small ghost" onclick="closeTaskModal()">Abbrechen</button>
      </div>
    </div>
  </div>

  <div class="modal" id="eventModal">
    <div class="modal-card">
      <h3 style="margin:0 0 8px 0">â• Neuer Termin</h3>
      <input id="eTitle" type="text" placeholder="Titel" style="margin-bottom:8px" />
      <input id="eDate" type="date" style="margin-bottom:8px" />
      <input id="eTime" type="text" placeholder="Uhrzeit (z.B. 14:00)" style="margin-bottom:8px" />
      <input id="eLocation" type="text" placeholder="Seite / Arbeitsblatt (z.B. Seite 24 oder Blatt A)" style="margin-bottom:8px" />
      <input id="eTaskNumber" type="text" placeholder="Aufgaben-Nummer (z.B. Aufgabe 5 oder Nr. 3-4)" style="margin-bottom:8px" />
      <div style="display:flex;gap:8px">
        <button class="btn small" onclick="saveEvent()">Speichern</button>
        <button class="btn small ghost" onclick="closeEventModal()">Abbrechen</button>
      </div>
    </div>
  </div>

  <script>
    const TEACHER_PASSWORD = 'HA113';
    const ADMIN_PASSWORD = 'ADMIN24';
    let currentRole = sessionStorage.getItem('role') || null;
    let isAuthenticated = !!currentRole;

    function updateRoleUI(){
      const badge = document.getElementById('roleBadge');
      badge.textContent = currentRole === 'teacher' ? 'ğŸ‘¨â€ğŸ« Lehrer'
                        : currentRole === 'admin' ? 'ğŸ‘¨â€ğŸ’¼ Admin'
                        : currentRole === 'student' ? 'ğŸ‘¤ SchÃ¼ler' : 'ğŸ‘¤ Gast';
      document.querySelectorAll('.admin-only').forEach(el=>el.style.display = (currentRole==='teacher'||currentRole==='admin')?'inline-flex':'none');
    }
    updateRoleUI();

    function openLogin(){ document.getElementById('loginModal').classList.add('show'); document.getElementById('pwSection').style.display='none'; document.getElementById('loginError').style.display='none'; }
    function closeLogin(){ document.getElementById('loginModal').classList.remove('show'); document.getElementById('pwInput').value=''; }

    let chosenRole = null;
    function pickRole(role, btn){
      chosenRole = role;
      document.querySelectorAll('.role-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      if(role === 'student'){
        currentRole = 'student'; isAuthenticated = true; sessionStorage.setItem('role', currentRole); updateRoleUI(); closeLogin(); return;
      }
      document.getElementById('roleText').textContent = role === 'teacher' ? 'ğŸ‘¨â€ğŸ« Lehrer-Passwort erforderlich' : 'ğŸ‘¨â€ğŸ’¼ Admin-Passwort erforderlich';
      document.getElementById('pwSection').style.display = 'block';
      document.getElementById('pwInput').focus();
    }

    function confirmLogin(){
      const pw = document.getElementById('pwInput').value || '';
      const correct = chosenRole === 'teacher' ? TEACHER_PASSWORD : ADMIN_PASSWORD;
      if(pw === correct){ currentRole = chosenRole; isAuthenticated = true; sessionStorage.setItem('role', currentRole); updateRoleUI(); closeLogin(); }
      else { const e = document.getElementById('loginError'); e.style.display='block'; e.textContent='âŒ Falsches Passwort'; }
    }

    function loadData(key){ return JSON.parse(localStorage.getItem(key) || '[]') }
    function saveData(key, arr){ localStorage.setItem(key, JSON.stringify(arr)) }

    function renderTasks(){
      const list = document.getElementById('tasks'); list.innerHTML='';
      const tasks = loadData('tasks');
      if(tasks.length===0){ list.innerHTML='<div class="meta">Keine Aufgaben eingetragen.</div>'; return; }
      tasks.forEach((t,i)=>{
        const li = document.createElement('li'); li.className='item';
        li.innerHTML = `<div>
          <div style="font-weight:800">${t.title}</div>
          <div class="meta">${t.subject || 'âˆ’'} â€¢ ${t.level || 'âˆ’'} â€¢ ${t.deadline || 'kein Datum'}</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn small ghost" onclick="toggleDone(${i})">${t.done?'âœ”':'â­•'}</button>
          <button class="btn small ghost" onclick="delTask(${i})">ğŸ—‘</button>
        </div>`;
        if(t.done) li.style.opacity=.6;
        list.appendChild(li);
      });
    }

    function renderEvents(){
      const list = document.getElementById('events'); list.innerHTML='';
      const ev = loadData('events');
      if(ev.length===0){ list.innerHTML='<div class="meta">Keine Termine.</div>'; return; }
      ev.forEach((e,i)=>{
        const li=document.createElement('li'); li.className='item';
        const extras = [];
        if(e.time) extras.push(e.time);
        if(e.location) extras.push(e.location);
        if(e.taskNumber) extras.push(e.taskNumber);
        const metaText = `${e.date}${ extras.length ? ' â€¢ ' + extras.join(' â€¢ ') : '' }`;
        li.innerHTML = `<div>
          <div style="font-weight:800">${e.title}</div>
          <div class="meta">${metaText}</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn small ghost" onclick="delEvent(${i})">ğŸ—‘</button>
        </div>`;
        list.appendChild(li);
      });
    }

    function openTaskModal(){
      if(!(currentRole==='teacher' || currentRole==='admin')){ alert('Nur Lehrer und Admins dÃ¼rfen Aufgaben hinzufÃ¼gen'); return; }
      document.getElementById('taskModal').classList.add('show');
    }
    function closeTaskModal(){ document.getElementById('taskModal').classList.remove('show'); }
    function saveTask(){
      if(!(currentRole==='teacher' || currentRole==='admin')){ alert('Keine Berechtigung'); closeTaskModal(); return; }
      const title=document.getElementById('tName').value.trim(); if(!title){ alert('Titel benÃ¶tigt'); return; }
      const tasks = loadData('tasks');
      tasks.push({ title, description:document.getElementById('tDesc').value||'', subject:document.getElementById('tSubject').value||'', level:document.getElementById('tLevel').value||'', deadline:document.getElementById('tDeadline').value||'', done:false });
      saveData('tasks',tasks); closeTaskModal(); renderTasks();
      ['tName','tDesc','tSubject','tDeadline'].forEach(id=>document.getElementById(id).value='');
    }
    function delTask(i){ if(!confirm('Aufgabe lÃ¶schen?')) return; const tasks=loadData('tasks'); tasks.splice(i,1); saveData('tasks',tasks); renderTasks(); }
    function toggleDone(i){ const tasks=loadData('tasks'); tasks[i].done=!tasks[i].done; saveData('tasks',tasks); renderTasks(); }

    function openEventModal(){ if(!(currentRole==='teacher'||currentRole==='admin')){ alert('Nur Lehrer und Admins dÃ¼rfen Termine hinzufÃ¼gen'); return; } document.getElementById('eventModal').classList.add('show'); }
    function closeEventModal(){ document.getElementById('eventModal').classList.remove('show'); }
    function saveEvent(){
      if(!(currentRole==='teacher'||currentRole==='admin')){ alert('Keine Berechtigung'); closeEventModal(); return; }
      const title=document.getElementById('eTitle').value.trim(); const date=document.getElementById('eDate').value;
      if(!title || !date){ alert('Titel und Datum benÃ¶tigt'); return; }
      const time = document.getElementById('eTime').value.trim();
      const location = document.getElementById('eLocation').value.trim();
      const taskNumber = document.getElementById('eTaskNumber').value.trim();
      const events = loadData('events'); events.push({ title, date, time: time || '', location: location || '', taskNumber: taskNumber || '' });
      saveData('events',events); closeEventModal(); renderEvents();
      ['eTitle','eDate','eTime','eLocation','eTaskNumber'].forEach(id=>document.getElementById(id).value='');
    }
    function delEvent(i){ if(!confirm('Termin lÃ¶schen?')) return; const ev=loadData('events'); ev.splice(i,1); saveData('events',ev); renderEvents(); }

    function saveNote(){ const v=document.getElementById('noteInput').value.trim(); if(!v) return; const n=loadData('notes'); n.push({text:v,at:new Date().toISOString()}); saveData('notes',n); renderNotes(); document.getElementById('noteInput').value=''; }
    function renderNotes(){ const list=document.getElementById('notes'); list.innerHTML=''; const n=loadData('notes'); if(n.length===0){ list.innerHTML='<div class="meta">Keine Notizen.</div>'; return; } n.forEach((no,i)=>{ const li=document.createElement('li'); li.className='item'; li.innerHTML=`<div><div>${no.text}</div><div class="meta">${new Date(no.at).toLocaleString()}</div></div><div><button class="btn small ghost" onclick="delNote(${i})">ğŸ—‘</button></div>`; list.appendChild(li); }) }
    function delNote(i){ const n=loadData('notes'); n.splice(i,1); saveData('notes',n); renderNotes(); }
    function clearNotes(){ if(!confirm('Alle Notizen lÃ¶schen?')) return; saveData('notes',[]); renderNotes(); }

    function toggleGamePanel(){
      const body = document.getElementById('gameBody');
      body.classList.toggle('show');
      document.getElementById('gameToggleLabel').textContent = body.classList.contains('show') ? 'GeÃ¶ffnet' : 'Klicken um zu Ã¶ffnen';
    }

    const canvas = document.getElementById('gameCanvas'); const ctx = canvas.getContext('2d');
    let W=0,H=0; function resize(){ W=canvas.width=canvas.offsetWidth; H=canvas.height=canvas.offsetHeight; } window.addEventListener('resize',resize); resize();
    let gameInterval=null, frame=0, score=0, best = parseInt(localStorage.getItem('flappyPersonBest')||'0',10); document.getElementById('gbest').textContent=best;
    let player={x:80,y:150,w:36,h:36,vy:0}; const gravity=0.6, jump=-11, gap=140, pipeW=70, speed=3; let pipes=[];

    function startGame(){
      if(!isAuthenticated){ alert('âŒ Bitte anmelden (SchÃ¼ler, Lehrer oder Admin) um zu spielen'); return; }
      resetGame(); if(gameInterval) cancelAnimationFrame(gameInterval); gameLoop();
    }
    function stopGame(){ if(gameInterval) cancelAnimationFrame(gameInterval); gameInterval=null; alert('Spiel gestoppt'); }
    function resetGame(){ score=0; pipes=[]; frame=0; player.y=H/2; player.vy=0; document.getElementById('gscore').textContent=0; }
    function spawnPipe(){ const top = Math.random()*(H-gap-120)+60; pipes.push({x:W,top}); }
    function drawPerson(x,y,w,h){ ctx.fillStyle='#FFD59A'; ctx.fillRect(x+6,y+10,w-12,h-10); ctx.beginPath(); ctx.arc(x+w/2,y+8,8,0,Math.PI*2); ctx.fillStyle='#FFE0B2'; ctx.fill(); ctx.fillStyle='#000'; ctx.fillRect(x+w/2-6,y+6,3,3); ctx.fillRect(x+w/2+2,y+6,3,3); }

    function gameLoop(){
      resize(); ctx.fillStyle='#87ceeb'; ctx.fillRect(0,0,W,H);
      if(frame%100===0) spawnPipe();
      pipes.forEach((p,i)=>{ p.x -= speed; ctx.fillStyle='#2ea44f'; ctx.fillRect(p.x,0,pipeW,p.top); ctx.fillRect(p.x,p.top+gap,pipeW,H-p.top-gap); if(!p.passed && p.x+pipeW < player.x){ p.passed=true; score++; document.getElementById('gscore').textContent=score; } });
      pipes = pipes.filter(p=>p.x+pipeW> -10);
      player.vy += gravity; player.y += player.vy; drawPerson(player.x,player.y,player.w,player.h);
      if(player.y+player.h >= H || player.y <= 0){ endGame(); return; }
      for(const p of pipes){ if(player.x+player.w > p.x && player.x < p.x+pipeW){ if(player.y < p.top || player.y+player.h > p.top+gap){ endGame(); return; } } }
      frame++; gameInterval = requestAnimationFrame(gameLoop);
    }

    function jumpPerson(){ if(!gameInterval) return; player.vy = jump; }
    function endGame(){ if(gameInterval) cancelAnimationFrame(gameInterval); gameInterval=null; if(score>best){ best=score; localStorage.setItem('flappyPersonBest',best); document.getElementById('gbest').textContent=best; alert('ğŸ† Neuer Highscore: '+score); } else alert('ğŸ’¥ Game Over â€” Score: '+score); }

    canvas.addEventListener('click', ()=>{ if(!gameInterval) return; jumpPerson(); });
    window.addEventListener('keydown', (e)=>{ if(e.code==='Space'){ e.preventDefault(); if(gameInterval) jumpPerson(); } if(e.code==='Escape'){ if(gameInterval) endGame(); document.getElementById('gameBody').classList.remove('show'); document.getElementById('gameToggleLabel').textContent='Klicken um zu Ã¶ffnen'; } });

    function init(){ renderTasks(); renderEvents(); renderNotes(); updateRoleUI(); document.querySelectorAll('.admin-only').forEach(el=>el.style.display=(currentRole==='teacher'||currentRole==='admin')?'inline-flex':'none'); }
    init();
  </script>
  
<save-data></save-data>

</body>
